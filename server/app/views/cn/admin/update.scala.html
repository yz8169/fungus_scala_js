@import models.Tables.BasicinfoRow
@import models.Tables.ClassifyRow
@(allInfo: (BasicinfoRow, ClassifyRow))
@basicInfo = @{
	allInfo._1
}
@classify = @{
	allInfo._2
}
@cn.admin.main("更新菌种信息") {
	<form class="registration-form form-horizontal" id="form"
	accept-charset="UTF-8" method="post" style="margin: 20px;">
		<div class="row">
			<div class="form-group col-sm-12">
				<h2 class="page-heading"
				style="text-align: left;
					border-bottom: 5px solid #e9f3f4">更新菌种信息</h2>
			</div>
		</div>

		<div class="row" style="line-height: 35px;">
			<div class="form-group col-sm-12">
				<strong>基本信息</strong>
			</div>
		</div>

		<div class="form-group">
			<label class="control-label col-sm-2">菌种编号：</label>
			<div class="col-sm-2">
				<input class="form-control" name="id" id="myCheckbox" value="@basicInfo.id" readonly>
			</div>
			<label class="control-label col-sm-2">原始编号：</label>
			<div class="col-sm-2">
				<input class="form-control" name="originalId" required value="@basicInfo.originalid">
			</div>
			<label class="control-label col-sm-2">中文名称:</label>
			<div class="col-sm-2">
				<input class="form-control" name="chineseName" required value="@basicInfo.chinesename">
			</div>
		</div>

		<div class="form-group">
			<label class="control-label col-sm-2">来源历史:</label>
			<div class="col-sm-6">
				<input class="form-control" name="source" required value="@basicInfo.source">
			</div>
			<label class="control-label col-sm-2">收藏时间:</label>
			<div class="col-sm-2">
				<input class="form-control datepicker" readonly="readonly" name="storeTime" id="datePicker"
				value="@basicInfo.storetime">
			</div>
		</div>

		<div class="form-group">
			<label class="control-label col-sm-2">原产国:</label>
			<div class="col-sm-2">
				<input class="form-control" name="oPCountry" required value="@basicInfo.opcountry">
			</div>
			<label class="control-label col-sm-2">分离基物:</label>
			<div class="col-sm-2">
				<input class="form-control" name="habitat" required value="@basicInfo.habitat">
			</div>
			<label class="control-label col-sm-2">培养温度:</label>
			<div class="col-sm-2">
				<input class="form-control" name="cTemperature" required value="@basicInfo.ctemperature">
			</div>
		</div>

		<div class="form-group">
			<label class="control-label col-sm-2">主要特征特性:</label>
			<div class="col-sm-10">
				<input class="form-control" name="mCharacteristic" required value="@basicInfo.mcharacteristic">
			</div>
		</div>

		<div class="form-group">
			<label class="control-label col-sm-2">保藏类型：</label>
			<div class="col-sm-2">
				<input class="form-control" name="pKind" required value="@basicInfo.pkind">
			</div>
			<label class="control-label col-sm-2">保存方法：</label>
			<div class="col-sm-2">
				<input class="form-control" name="pMethod" required value="@basicInfo.pmethod">
			</div>
			<label class="control-label col-sm-2">生物危害程度：</label>
			<div class="col-sm-2">
				<input class="form-control" name="bHLevel" required value="@basicInfo.bhlevel">
			</div>
		</div>

		<div class="form-group">
			<label class="control-label col-sm-2">实物状态：</label>
			<div class="col-sm-2">
				<input class="form-control" name="pState" required value="@basicInfo.pstate">
			</div>
			<label class="control-label col-sm-3">培养基编号（名称或配方）:</label>
			<div class="col-sm-5">
				<input class="form-control" name="cNumber" required value="@basicInfo.cnumber">
			</div>
		</div>

		<div class="row" style="line-height: 35px;">
			<div class="form-group col-sm-12">
				<strong>属信息</strong>
			</div>
		</div>

		<div class="form-group">
			<label class="control-label col-sm-2">门名：</label>
			<div class="col-sm-4">
				<input class="form-control" name="phylum" required value="@classify.phylum">
			</div>
			<label class="control-label col-sm-2">纲名：</label>
			<div class="col-sm-4">
				<input class="form-control" name="outline" required value="@classify.outline">
			</div>
		</div>

		<div class="form-group">
			<label class="control-label col-sm-2">目名：</label>
			<div class="col-sm-4">
				<input class="form-control" name="order" required value="@classify.order">
			</div>
			<label class="control-label col-sm-2">科名：</label>
			<div class="col-sm-4">
				<input class="form-control" name="family" required value="@classify.family">
			</div>
		</div>

		<div class="form-group">
			<label class="control-label col-sm-2">属名：</label>
			<div class="col-sm-4">
				<input class="form-control" name="genus" required value="@classify.genus">
			</div>
			<label class="control-label col-sm-2">种名：</label>
			<div class="col-sm-4">
				<input class="form-control" name="species" required value="@classify.species">
			</div>
		</div>

		<div class="row" style="line-height: 35px;">
			<div class="form-group col-sm-12">
				<strong>序列信息</strong>
			</div>
		</div>

		<div class="form-group">
			<label class="control-label col-sm-2">ITS序列：</label>
			<div class="col-sm-4">
				<input class="form-control" name="its" required value="@basicInfo.its">
			</div>
			<label class="control-label col-sm-2">18s序列：</label>
			<div class="col-sm-4">
				<input class="form-control" name="eighteenS" required value="@basicInfo.eighteens">
			</div>
		</div>

		<div class="row" style="line-height: 35px;">
			<div class="form-group col-sm-12">
				<strong>库存信息</strong>
			</div>
		</div>

		<div class="form-group">
			<label class="control-label col-sm-2">价格：</label>
			<div class="col-sm-4">
				<input class="form-control" name="price" required value="@basicInfo.price">
			</div>
			<label class="control-label col-sm-2">库存：</label>
			<div class="col-sm-4">
				<input class="form-control" name="inventory" required value="@basicInfo.inventory">
			</div>
		</div>


		<div class="form-group">
			<div class="actions col-sm-12">
				<input type="button" id="submit" value="更新菌种信息"
				class="button primary" style="width: 100%;">
			</div>
		</div>
	</form>
	<script>
			$(document).ready(function () {
				$("#submit").click(function () {
					var form = $("#form")
					var bv = form.data("bootstrapValidator")
					bv.validate()
					if (bv.isValid()) {
						$.ajax({
							url: "updateAllInfo",
							type: "post",
							data: form.serialize(),
							success: function (data) {
								swal("成功！", "更新菌种信息成功！", "success")

							},
							error: function (e) {
								swal("错误", "更新失败！", "error")
							}
						});
					}
				})

				var infinityNumber = Number.MAX_VALUE
				$('#form').bootstrapValidator({
					feedbackIcons: {
						valid: 'glyphicon glyphicon-ok',
						invalid: 'glyphicon glyphicon-remove',
						validating: 'glyphicon glyphicon-refresh'
					},
					fields: {
						its: {
							validators: {
								regexp: {
									regexp: /^(([ATCG]+)||(NA))$/,
									message: "ITS序列不合法！"
								}
							}
						},
						eighteenS: {
							validators: {
								regexp: {
									regexp: /^(([ATCG]+)||(NA))$/,
									message: "18s序列不合法！"
								}
							}
						},
						price: {
							validators: {
								integer: {
									message: "价格必须为整数！"
								},
								between: {
									min: "1",
									max: infinityNumber,
									message: "价格必须大于0！"
								}
							}
						},
						inventory: {
							validators: {
								integer: {
									message: "库存必须为整数！"
								},
								between: {
									min: "0",
									max: infinityNumber,
									message: "库存必须大于等于0！"
								}
							}
						}
					}
				});

			})

			$("#datePicker").datepicker({
				format: "yyyy/mm/dd",
				language: "zh-CN"
			})

	</script>

}